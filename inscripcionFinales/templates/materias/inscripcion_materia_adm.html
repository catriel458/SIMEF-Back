{% extends 'base/base.html' %}

{% block title %}Inscripcion Materia{% endblock %}

{% block content %}
{% if request.user.is_staff or request.user.is_superuser or request.user.is_admin %}
<!DOCTYPE html>
<html>
<head>
    <title>Inscripción Materia</title>
    <style>
        body {
            overflow-y:hidden;
          }
    </style>  
</head>
<body>
    <h1>Inscripción Materia</h1>
    <div class="card" style="background-color: #d7d1dc">
        <div class="card-body">      
    <form method="post" style="font-size: 1.9em;">
        {% csrf_token %}
        
        <div class="mb-3">
            <label for="{{ form.usuario.id_for_label }}" class="form-label">{{ form.usuario.label }}:</label>
            {{ form.usuario }}
            {% if form.usuario.errors %}
                <div class="text-danger">{{ form.usuario.errors }}</div>
            {% endif %}
        </div>
        
        <div class="mb-3">
            <label for="{{ form.materia.id_for_label }}" class="form-label">{{ form.materia.label }}:</label>
            {{ form.materia }}
            {% if form.materia.errors %}
                <div class="text-danger">{{ form.materia.errors }}</div>
            {% endif %}
        </div>
        
        <div class="mb-3">
            <label for="{{ form.modalidad.id_for_label }}" class="form-label">{{ form.modalidad.label }}:</label>
            {{ form.modalidad }}
            {% if form.modalidad.errors %}
                <div class="text-danger">{{ form.modalidad.errors }}</div>
            {% endif %}
        </div>
        
        <!-- NUEVOS CAMPOS AGREGADOS - Solo visibles cuando modalidad es "Itinerante" -->
        <div class="mb-3" id="div_institucion" style="display: block;">
            <label for="{{ form.institucion.id_for_label }}" class="form-label">{{ form.institucion.label }}:</label>
            {{ form.institucion }}
            {% if form.institucion.errors %}
                <div class="text-danger">{{ form.institucion.errors }}</div>
            {% endif %}
        </div>
        
        <div class="mb-3" id="div_turno" style="display: block;">
            <label for="{{ form.turno.id_for_label }}" class="form-label">{{ form.turno.label }}:</label>
            {{ form.turno }}
            {% if form.turno.errors %}
                <div class="text-danger">{{ form.turno.errors }}</div>
            {% endif %}
        </div>
        <!-- FIN NUEVOS CAMPOS -->
        
        <script>
            // Ocultar campo aprobada si existe
            if (document.getElementById("id_aprobada")) {
                document.getElementById("id_aprobada").hidden = true;
                document.getElementById("id_aprobada").previousElementSibling.hidden = true;
            }
            
            
            // Ejecutar al cargar la página
            document.addEventListener('DOMContentLoaded', function() {
                toggleCamposItinerante();
                
                // Agregar listener al cambio de modalidad
                const modalidadSelect = document.getElementById('id_modalidad');
                if (modalidadSelect) {
                    modalidadSelect.addEventListener('change', toggleCamposItinerante);
                }
            });
        </script>
        <br>
        <button class="btn btn-primary" type="submit" style="margin-left: 90px;">Inscribirse</button>
    </form>
    {% else %}

    <div class="text-center">
        <img src="/static/imagenes/error403.jpg" class="rounded"></img>
        <br>
      <h3>No deberías estar acá. Para volver, <a href="/">hace click acá</a></h3>
    </div>
</div>
</div>
    {% endif %}
    {%endblock%}
</body>
</html>